<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Quality requirements for BON in a Box analysis pipelines – BON in a Box</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BON in a Box</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./how_to_install.html"> 
<span class="menu-text">Install</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./how_to_use.html"> 
<span class="menu-text">User Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-pipelines" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Pipelines</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-pipelines">    
        <li>
    <a class="dropdown-item" href="./protconn_pipeline.html">
 <span class="dropdown-text">Protected Connected Index</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contribute-a-pipeline" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contribute a pipeline</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-contribute-a-pipeline">    
        <li>
    <a class="dropdown-item" href="./contributing.html">
 <span class="dropdown-text">Interested in Contributing?</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./how_to_contribute.html">
 <span class="dropdown-text">Contribution instructions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pipeline_standards.html">
 <span class="dropdown-text">Pipeline standards</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./peer_review.html"> 
<span class="menu-text">Peer review</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Quality requirements for BON in a Box analysis pipelines</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./Biab_large.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link active" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#guidelines-and-requirements" id="toc-guidelines-and-requirements" class="nav-link" data-scroll-target="#guidelines-and-requirements">Guidelines and Requirements</a>
  <ul class="collapse">
  <li><a href="#analysis-types" id="toc-analysis-types" class="nav-link" data-scroll-target="#analysis-types">Analysis types</a></li>
  <li><a href="#data-standards" id="toc-data-standards" class="nav-link" data-scroll-target="#data-standards">Data standards</a></li>
  <li><a href="#code-standards" id="toc-code-standards" class="nav-link" data-scroll-target="#code-standards">Code standards</a></li>
  <li><a href="#yaml-description-files" id="toc-yaml-description-files" class="nav-link" data-scroll-target="#yaml-description-files">YAML description files</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation"><strong>Documentation</strong></a></li>
  <li><a href="#versioning" id="toc-versioning" class="nav-link" data-scroll-target="#versioning"><strong>Versioning</strong></a></li>
  <li><a href="#licensing" id="toc-licensing" class="nav-link" data-scroll-target="#licensing"><strong>Licensing</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quality requirements for BON in a Box analysis pipelines</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<ul>
<li><p>BON in a Box is community-driven and open tool for biodiversity modeling and indicator calculation developed by GEO BON</p></li>
<li><p>BON in a Box connects individual analysis into pipelines that are contributed by experts</p></li>
<li><p>Contributed pipelines should be generalizable, user-friendly, scientifically robust, and well documented</p></li>
<li><p>This document outlines a set of standards for analysis pipelines to meet these requirements</p></li>
</ul>
</section>
<section id="glossary" class="level2">
<h2 class="anchored" data-anchor-id="glossary">Glossary</h2>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Script</td>
<td>A sequence of code written in a programming language that accomplishes a single task, such as data cleaning, analysis, visualization, or modeling.</td>
</tr>
<tr class="even">
<td>Pipeline</td>
<td>A sequence of scripts connected to automate an entire analysis workflow, from the input parameters to the analysis result.</td>
</tr>
<tr class="odd">
<td>Biodiversity Observation Network (BON)</td>
<td>A network of observation sites or stations and/or a network of experts and groups who collect and analyze biodiversity data for different needs. A BON coordinates monitoring efforts to support conservation policy and/or management action from national biodiversity strategies and action plans. A BON can be regional (e.g.&nbsp;Europe, Asia-Pacific), national (e.g.&nbsp;Japan), or thematic (e.g.&nbsp;Marine, Freshwater).</td>
</tr>
<tr class="even">
<td>Essential Biodiversity Variable (EBV)</td>
<td>“A biological variable that critically contributes to the characterization of Earth’s biodiversity; they are a minimum set of common and complementary sets of observable variables across the dimensions of biodiversity that can be used to create indicators of system-level biodiversity trends” (after <a href="https://doi.org/10.1016/j.biocon.2016.09.006">Brummitt et al.&nbsp;2017</a>. EBVs provide scalable, comparable metrics that can be aggregated into time-series or spatial maps, enabling the detection of patterns and drivers of biodiversity change.</td>
</tr>
<tr class="odd">
<td>Indicator</td>
<td>A derived metric informed by biodiversity datasets (e.g.&nbsp;EBVs) that summarizes biodiversity information into a single value that can help track changes in biodiversity status or the pressures affecting it, thereby providing measurable data that informs policy decisions and conservation actions. In the context of the Kunming-Montreal Global Biodiversity Framework, an indicator is used to assess progress toward the framework’s goals and targets.</td>
</tr>
<tr class="even">
<td>Kunming-Montreal Global Biodiversity Framework (GBF)</td>
<td>The latest agreement of the United Nations Convention on Biological Diversity (CBD) adopted by 196 Parties at its 15th Conference of the Parties in December 2022. The GBF sets an ambitious pathway to reach a global vision of living in harmony with nature and halting biodiversity loss by 2050 and supports the achievement of the Sustainable Development Goals (CBD, 2022a). |</td>
</tr>
<tr class="odd">
<td>GBF Monitoring Framework</td>
<td>The Monitoring framework is designed to track progress toward the goals and targets of the GBF through a set of indicators. It emphasizes the need for consistent data collection, reporting, and evaluation at national and global levels to ensure accountability and transparency. It calls upon the development of national and regional monitoring systems, including the technologies, tools, networks and communities needed to sustain monitoring.</td>
</tr>
<tr class="even">
<td>FAIR principles</td>
<td>Four foundational principles of data - findability, accessibility, interoperability, and reusability - which aim to increase the openness, equity, and integrity of the scientific process. See <a href="https://www.go-fair.org/fair-principles/" class="uri">https://www.go-fair.org/fair-principles/</a></td>
</tr>
</tbody>
</table>
</section>
<section id="guidelines-and-requirements" class="level2">
<h2 class="anchored" data-anchor-id="guidelines-and-requirements">Guidelines and Requirements</h2>
<section id="analysis-types" class="level3">
<h3 class="anchored" data-anchor-id="analysis-types">Analysis types</h3>
<p>BON in a Box is a platform to share expertise and knowledge and promote collaboration by allowing scientists to share analysis workflows in an organized and open way. BON in a Box has three main groups of pipelines:</p>
<ol type="1">
<li><p><strong>Pipelines for reporting:</strong> Pipelines to calculate Essential Biodiversity Variables and indicators that are in the Convention on Biological Diversity’s Global Biodiversity Framework. These pipelines have undergone a more rigorous peer review process and must adhere to the EBV guidelines and/or the official methodology in the GBF’s Monitoring Framework outlined in the <a href="https://www.gbf-indicators.org/">UNEP-WCMC documentation</a>, if it exists. Pipelines will be created or reviewed by members of the EBV working group or the custodial institution to assure that they follow standards for reporting. These pipelines will be accompanied by a tag that specifies them as reporting ready.</p></li>
<li><p><strong>General biodiversity monitoring:</strong> Pipelines that are relevant to biodiversity monitoring at any scale but don’t have direct relevance to national reporting through the CBD. These pipelines can be more directed at specific biomes, habitats, or ecosystems but still useful to share between national or thematic biodiversity observation networks.&nbsp;</p></li>
<li><p><strong>Pipelines for sampling prioritization:</strong> Pipelines to help build national BONs by prioritizing sampling areas based on different criteria such as environmental distance, presence of threatened species, or accessibility. These sampling pipelines will help national and regional BONs expand their sampling programs in a systematic way.&nbsp;</p></li>
</ol>
<p>Additionally, all analyses must be:</p>
<ul>
<li><p><strong>Generalizable:</strong> BON in a Box is a platform for sharing analyses between BONs, so contributed pipelines must be generalizable between different areas, taxa, spatial scales, etc. Analyses should not be specific to one region, species, or context.&nbsp;</p></li>
<li><p><strong>Scalable:</strong> Pipelines should be able to be calculated at different scales.</p></li>
<li><p><strong>Scientifically robust:</strong> Pipelines should follow a method that has been published in the literature or verified in some way. Sometimes, pipeline and method development will happen concurrently but pipelines will keep the “experimental pipeline” tag until the science has been verified by independent experts. Ideally, models will be ground-truthed with independent data sources.</p></li>
<li><p><strong>FAIR:</strong> Findable, accessible, interoperable, and reproducible*</p></li>
<li><p><strong>Transparent:</strong> All pipelines must be open access and all code must be publicly available; intermediate steps should display outputs relevant for auditing purposes; any calculations run outside of BON in a Box and imported using APIs must be run on open access platforms so all results can be audited and reproduced. Analyses should, whenever possible, have some estimates of uncertainty, predictive power and goodness of fit measures.&nbsp;</p></li>
</ul>
</section>
<section id="data-standards" class="level3">
<h3 class="anchored" data-anchor-id="data-standards">Data standards</h3>
<p>BON in a Box is a data processing platform, not a data repository. However, to ensure that pipelines follow FAIR principles, the data that is analyzed must meet a set of standards.</p>
<p>BON in a Box is designed to run analyses with both publicly available data and data input by the user. This allows the user to customize the analysis with data that is more accurate to their region, taking ownership of the process without having to share their own data.&nbsp;</p>
<section id="naming-standards" class="level4">
<h4 class="anchored" data-anchor-id="naming-standards"><strong>Naming standards:</strong></h4>
<ul>
<li><p>Input and output file names should be machine readable, with no spaces, symbols, capital letters, or special characters. Spaces should be replaced with an underscore (_).</p></li>
<li><p>File names should be descriptive (e.g.&nbsp;“population_polygons.gpkg”).</p></li>
</ul>
</section>
<section id="standards-for-publicly-available-input-data" class="level4">
<h4 class="anchored" data-anchor-id="standards-for-publicly-available-input-data"><strong>Standards for publicly available input data:</strong></h4>
<ul>
<li><p>When using publicly available data, BON in a Box should use APIs when they are available so pipelines can be run with the most up to date data available.</p>
<ul>
<li>When processing GBIF data in a pipeline, the <strong>GBIF download API</strong> should be used to ensure reproducibility and citability, as it provides a download DOI for each run, and this doi script output must be included in the pipeline outputs. The “GBIF observations with download API” script should be used for basic GBIF data retrieval.&nbsp;</li>
</ul></li>
<li><p>Raster data should be in cloud optimized GeoTIFF (e.g.&nbsp;<a href="https://stacspec.org/en">STAC catalog</a>) formats whenever possible.&nbsp;</p>
<ul>
<li>The <a href="stac.geobon.org/viewer">GEO BON STAC catalog</a> and other STAC catalogs such as the <a href="https://planetarycomputer.microsoft.com/">planetary computer</a> can be accessed through the <a href="https://github.com/GEO-BON/bon-in-a-box-pipelines/blob/main/scripts/data/loadFromStac.R">load from STAC script</a>. For more information about how to use STAC catalogs, see these <a href="https://stacspec.org/en/tutorials/">tutorials</a>.</li>
</ul></li>
</ul>
</section>
<section id="standards-for-user-defined-input-data" class="level4">
<h4 class="anchored" data-anchor-id="standards-for-user-defined-input-data"><strong>Standards for user-defined input data:</strong></h4>
<ul>
<li><p><strong>Point, line, and polygon data</strong> should be in the form of a geopackage.</p>
<ul>
<li><p>The geometry column must be called “geom”.</p></li>
<li><p>Data should be in the coordinate reference system (CRS) appropriate for the region of interest (to find a CRS, search <a href="https://epsg.io/">here</a>).</p></li>
</ul></li>
<li><p><strong>Raster data</strong> should be a GeoTiff file</p>
<ul>
<li><p>Raster data should be projected into a coordinate reference system appropriate for the region of interest.</p></li>
<li><p>Multi-band rasters are allowed when the band names can be easily interpreted (e.g.&nbsp;year, species, model).&nbsp;</p></li>
</ul></li>
<li><p>Tabular data can be uploaded as CSV (comma separated values) or TSV (tab separated values). Column names should be in snake_case and should avoid special characters and capital letters. When geographical coordinates are included, use the CRS EPSG:4326 (latitude, longitude WGS 84) and column names “latitude” and “longitude”, whenever possible.&nbsp;</p>
<ul>
<li>Specific file formats and column formatting guidelines will depend on the pipeline and should be specified in the pipeline documentation.</li>
</ul></li>
</ul>
</section>
<section id="standards-for-output-data" class="level4">
<h4 class="anchored" data-anchor-id="standards-for-output-data"><strong>Standards for output data</strong></h4>
<p>Each BON in a Box script creates outputs that can be downloaded. They should be in standard file formats and follow these guidelines:</p>
<ul>
<li><p>Outputs should be in interoperable data formats (e.g.&nbsp;not a language specific format such as RData).</p></li>
<li><p>Point, line, and polygon data should be output as geopackages. Include just one layer per geopackage whenever possible.&nbsp;</p></li>
<li><p>Raster data should be output as a GeoTIFF, compressed (ex. Deflate or LZW).</p></li>
<li><p>Tabular data can be output as a comma separated values (CSV) or tab separated value (TSV) format.</p></li>
</ul>
</section>
</section>
<section id="code-standards" class="level3">
<h3 class="anchored" data-anchor-id="code-standards">Code standards</h3>
<p>BON in a Box is designed to be a fully open and transparent platform where all code is open and reproducible. This allows the user to audit the process and edit the code if necessary to customize the process. Therefore, code must be well formatted, readable, and well documented.&nbsp;</p>
<p>Code should adhere to the following requirements:</p>
<ul>
<li><p>File names should be machine readable, with no spaces, symbols, or special characters. Spaces should be delimited with an underscore (_).</p></li>
<li><p>Code must be divided into modular scripts that perform one task and can be reused in other pipelines.</p></li>
<li><p>Code should be well formatted with indents</p>
<ul>
<li><p>For R code, follow the <a href="https://style.tidyverse.org/files.html">tidyverse style guide</a> (with 120 character lines)</p></li>
<li><p>For Python code, follow the <a href="https://peps.python.org/pep-0008/">PEP-8 style guide</a></p></li>
<li><p>For Julia code, follow the custom <a href="https://github.com/PoisotLab/SpeciesDistributionToolkit.jl/blob/main/.JuliaFormatter.toml">formatting file</a>, which can be applied to scripts using the JuliaFormatter package</p></li>
</ul></li>
<li><p>Scripts should be well annotated with descriptions of each step commented within the code</p></li>
<li><p>Scripts should check and validate that user inputs are properly entered and are in the expected format. Scripts should output informative messages and stop the execution with the biab_error_stop() function when invalid inputs are detected.&nbsp;</p>
<ul>
<li>For example, if someone misspells a country name and the country polygon is not found, write if(is.null(country_polygon)) { biab_error_stop(“Country polygon not found. Check the spelling of the country name”)</li>
</ul></li>
<li><p>Each main step of the script prints a log (console output) message so the user can know at what stage the analysis is. The contributor is encouraged to add additional information messages that will be added to the log:</p>
<ul>
<li><p>Messages can be added with the biab_info() function. For example biab_info(“Study area downloaded”)</p></li>
<li><p>Warning messages can be added with the biab_warning() function.</p></li>
</ul></li>
<li><p>The script should provide informative error messages whenever mistakes are encountered using the biab_error_stop() function.</p></li>
</ul>
</section>
<section id="yaml-description-files" class="level3">
<h3 class="anchored" data-anchor-id="yaml-description-files">YAML description files</h3>
<p>Each script will be accompanied by a YAML description file (.yml format) that has a description of the script, specifies the inputs and outputs, defines the Conda dependencies, and provides references (see <a href="https://geo-bon.github.io/bon-in-a-box-pipeline-engine/how_to_contribute.html#step-1-creating-a-yaml-file">our documentation</a> for guidelines on how to format your YAML file).</p>
<section id="yaml-file-standards" class="level4">
<h4 class="anchored" data-anchor-id="yaml-file-standards"><strong>YAML file standards</strong></h4>
<ul>
<li><p>YAML files must have the same name as the script that they accompany with a .yml file extension</p></li>
<li><p>YAML files should have a thorough description section that includes the purpose of the script</p></li>
<li><p>YAML files should have the name, email, and ORCID (if available) of all script authors</p></li>
<li><p>Names of inputs and output <strong>IDs</strong> should be in <a href="https://en.wikipedia.org/wiki/Snake_case">snake case</a>, all lowercase with underscores for spaces</p></li>
<li><p>Input and output <strong>labels</strong> should be short, human readable and descriptive</p></li>
<li><p>Input and output <strong>descriptions</strong> should describe the format of the input and guide the user on parameterization using photos or links in the YAML description when necessary (see <a href="https://commonmark.org/help/">CommonMark reference</a> for formatting)</p></li>
<li><p>Users should be able to successfully run the pipeline with the example inputs</p></li>
<li><p>For <strong>file outputs, type</strong> should be written as a MIME type</p></li>
<li><p>For <strong>primitive outputs</strong>, such as text and numbers, use a primitive type (int, float, text). Refer to <a href="https://geo-bon.github.io/bon-in-a-box-pipeline-engine/how_to_contribute.html#inputs">the inputs section of the user documentation</a>.</p></li>
<li><p>The example will autofill in the document. If the example is a file, make sure the file is in the appropriate folder (note the ‘userdata’ folder is local only and will not be pushed to GitHub) and the file path starts at that folder (e.g.&nbsp;/scripts/data/protected_area_file_example.gpkg). Note BON in a Box cannot access the whole computer so the root must be in the BON in a Box pipelines folder. Make sure the whole script runs with the chosen examples.</p></li>
</ul>
<section id="conda-dependencies" class="level5">
<h5 class="anchored" data-anchor-id="conda-dependencies"><strong>Conda dependencies</strong></h5>
<p>Conda is a package, dependency, and environment management system that prevents scripts from encountering breaking changes when packages are updated. Conda environments should list all of the necessary packages and package versions should be specified when necessary. Conda sub-environments should only be specified when the required packages or package versions are not in the main environment.</p>
</section>
</section>
</section>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation"><strong>Documentation</strong></h3>
<section id="pipeline-metadata" class="level4">
<h4 class="anchored" data-anchor-id="pipeline-metadata"><strong>Pipeline metadata</strong></h4>
<p>Each pipeline contains metadata, which can be edited in the right sliding pane of the pipeline editor canvas. Pipeline metadata must contain:</p>
<ul>
<li><p>The name of the pipeline in human readable form</p></li>
<li><p>The description of the pipeline, including a short description of the methods, any data it is using, the limitations of the pipeline, and if it is an indicator in the GBF, what kind of indicator it is and which targets/goals it is related to</p></li>
<li><p>The license of the pipeline (this is chosen by the user, see section on licensing below)</p></li>
<li><p>The author(s) of the pipeline and their emails and ORCIDs</p></li>
<li><p>Any relevant references or links</p></li>
</ul>
</section>
<section id="pipeline-markdown-tutorial" class="level4">
<h4 class="anchored" data-anchor-id="pipeline-markdown-tutorial"><strong>Pipeline markdown tutorial</strong></h4>
<p>Each pipeline should be accompanied by a tutorial in markdown format. This document should have the same name as the pipeline JSON file but with a .md extension and be contained in the same folder as the pipeline it describes. This tutorial should contain a more thorough description of the methods (around 2-3 paragraphs). The tutorial should provide guidance on how to parameterize the pipeline, and walk through a full example analysis. This document should also more thoroughly communicate the limitations of the pipeline in terms of the species, regions, and scales at which it is relevant. See example <a href="https://boninabox.geobon.org/indicator?i=ProtConn">here</a>.</p>
</section>
</section>
<section id="versioning" class="level3">
<h3 class="anchored" data-anchor-id="versioning"><strong>Versioning</strong></h3>
<p>Creating pipelines to calculate Essential Biodiversity Variables and indicators is an iterative process, and pipelines will deprecate over time as methods are updated. Therefore, we will have a structured versioning system as pipelines are released.&nbsp;</p>
<p>Versioning will follow a semantic versioning style in the form of major.minor.patch.</p>
<ul>
<li><p>Non peer-reviewed or stable pipelines should have versions starting with 0.*</p></li>
<li><p>The first peer-reviewed stable version of the pipeline will be released as 1.0.0.</p></li>
<li><p>Minor bug fixes will be released continuously (e.g.&nbsp;1.0.1).</p></li>
<li><p>Any major changes to methods or packages will be a scheduled major release (e.g.&nbsp;2.0.0). The old pipeline will be labeled as deprecated but will still be available for backwards compatibility.</p></li>
</ul>
</section>
<section id="licensing" class="level3">
<h3 class="anchored" data-anchor-id="licensing"><strong>Licensing</strong></h3>
<p>The BON in a Box software is under the <a href="https://www.gnu.org/licenses/quick-guide-gplv3.html">GPLv3</a> license, but each pipeline is licensed individually, with the specific license chosen by the contributor. Our recommended license is MIT. You can explore licenses <a href="https://choosealicense.com/">here</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>